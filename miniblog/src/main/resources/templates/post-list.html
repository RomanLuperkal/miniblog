<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Posts</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .post-form {
            margin-top: 20px;
            display: none; /* По умолчанию скрыта */
        }

        .user-info {
            font-size: 1rem;
            font-weight: bold;
        }

        .post-feed {
            max-height: 500px; /* Ограничиваем высоту для скроллинга */
            overflow-y: auto; /* Включаем вертикальный скролл */
        }

        .card {
            width: 70%; /* Уменьшаем ширину карточек */
            margin: 10px auto; /* Центрируем карточки */
        }

        h1 {
            text-align: center; /* Центруем заголовок */
        }

        .add-post-container {
            display: flex;
            justify-content: center; /* Центруем кнопку */
            margin-bottom: 20px;
        }

        .add-post-container button {
            width: 150px;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <!-- Заголовок и информация о пользователе -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <span></span> <!-- Пустой элемент для выравнивания -->
        <h1>Posts</h1>
        <span th:text="${userName}" class="text-muted user-info"></span>
    </div>

    <!-- Кнопка добавления поста -->
    <div class="add-post-container">
        <button id="addPostButton" class="btn btn-primary">Add Post</button>
    </div>

    <!-- Форма для добавления поста -->
    <div class="card post-form p-4" id="postForm">
        <h3 class="text-center">Add New Post</h3>
        <form th:action="@{/posts/add}" method="post" enctype="multipart/form-data">
            <div class="mb-3">
                <label for="postName" class="form-label">Post Name</label>
                <input type="text" id="postName" name="postName" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="image" class="form-label">Image</label>
                <input type="file" id="image" name="image" class="form-control" accept="image/*" required>
            </div>
            <div class="mb-3">
                <label for="text" class="form-label">Text</label>
                <textarea id="text" name="text" class="form-control" rows="5" required></textarea>
            </div>
            <div class="mb-3">
                <label for="tag" class="form-label">Tags (comma separated)</label>
                <input type="text" id="tag" name="tag" class="form-control" required>
            </div>
            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-success">Save Post</button>
            </div>
        </form>
    </div>

    <!-- Лента постов -->
    <div class="post-feed">
        <div th:each="post : ${posts}" class="card">
            <div class="card-body">
                <h5 class="card-title" th:text="${post.postName}">Post Name</h5>
                <p class="card-text" th:text="${post.text}">Post Text</p>
                <img th:src="${post.image}" class="img-fluid" alt="Post Image">
                <span class="badge bg-secondary" th:text="${post.tag}">Tag</span>
            </div>
            <div class="card-footer d-flex justify-content-between">
                <span th:text="'Likes: ' + ${post.likesCount}">Likes: 0</span>
                <span th:text="'Comments: ' + ${post.commentsCount}">Comments: 0</span>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Отображение формы при нажатии на кнопку
    document.getElementById('addPostButton').addEventListener('click', function () {
        const form = document.getElementById('postForm');
        form.style.display = form.style.display === 'none' ? 'block' : 'none';
    });
</script>
</body>
</html>
